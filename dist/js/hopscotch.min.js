/**! hopscotch - v0.3.1.1
*
* Copyright 2017 LinkedIn Corp. All rights reserved.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*     http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.hopscotch=e()}(this,function(){"use strict";var t,e,n,o,i,r,s,l,a,u,c,h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f="bubble_default",d=window.Sizzle||null,p="undefined",g=!1,v=("undefined"==typeof jQuery?"undefined":h(jQuery))!==p,m=!1,b=!1,w=/^[a-zA-Z]+[a-zA-Z0-9_-]*$/,y={left:"right",right:"left"};try{h(window.sessionStorage)!==p&&(m=!0,sessionStorage.setItem("hopscotch.test.storage","ok"),sessionStorage.removeItem("hopscotch.test.storage"),b=!0)}catch(t){}return u={smoothScroll:!0,scrollDuration:1e3,scrollTopMargin:200,showCloseButton:!0,showPrevButton:!1,showNextButton:!0,bubbleWidth:280,bubblePadding:15,arrowWidth:20,skipIfNoElement:!0,isRtl:!1,cookieName:"hopscotch.tour.state"},Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),(s={addClass:function(t,e){var n,o,i,r;if(t.className){for(o=e.split(/\s+/),n=" "+t.className+" ",i=0,r=o.length;i<r;++i)n.indexOf(" "+o[i]+" ")<0&&(n+=o[i]+" ");t.className=n.replace(/^\s+|\s+$/g,"")}else t.className=e},removeClass:function(t,e){var n,o,i,r;for(o=e.split(/\s+/),n=" "+t.className+" ",i=0,r=o.length;i<r;++i)n=n.replace(" "+o[i]+" "," ");t.className=n.replace(/^\s+|\s+$/g,"")},hasClass:function(t,e){return!!t.className&&-1!==(" "+t.className+" ").indexOf(" "+e+" ")},getPixelValue:function(t){var e=void 0===t?"undefined":h(t);return"number"===e?t:"string"===e?parseInt(t,10):0},valOrDefault:function(t,e){return(void 0===t?"undefined":h(t))!==p?t:e},invokeCallbackArrayHelper:function(t){var e;if(Array.isArray(t)&&"function"==typeof(e=a[t[0]]))return e.apply(this,t.slice(1))},invokeCallbackArray:function(t){var e,n;if(Array.isArray(t)){if("string"==typeof t[0])return s.invokeCallbackArrayHelper(t);for(e=0,n=t.length;e<n;++e)s.invokeCallback(t[e])}},invokeCallback:function(t){return"function"==typeof t?t():"string"==typeof t&&a[t]?a[t]():s.invokeCallbackArray(t)},invokeEventCallbacks:function(t,e){var n,o,i=l[t];if(e)return this.invokeCallback(e);for(n=0,o=i.length;n<o;++n)this.invokeCallback(i[n].cb)},getScrollTop:function(){return h(window.pageYOffset)!==p?window.pageYOffset:document.documentElement.scrollTop},getScrollLeft:function(){return h(window.pageXOffset)!==p?window.pageXOffset:document.documentElement.scrollLeft},getWindowHeight:function(){return window.innerHeight||document.documentElement.clientHeight},addEvtListener:function(t,e,n){if(t)return t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)},removeEvtListener:function(t,e,n){if(t)return t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent("on"+e,n)},documentIsReady:function(){return"complete"===document.readyState},evtPreventDefault:function(t){t.preventDefault?t.preventDefault():event&&(event.returnValue=!1)},extend:function(t,e){var n;for(n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},getElementByIdentifier:function(t){var e=document.getElementById(t);if(e)return e;if(v)return(e=jQuery(t)).length?e[0]:null;if(d)return(e=new d(t)).length?e[0]:null;if(document.querySelector)try{return document.querySelector(t)}catch(t){}return/^#[a-zA-Z][\w-_:.]*$/.test(t)?document.getElementById(t.substring(1)):null},getContainer:function(t){return t.container?"string"==typeof t.container?s.getElementByIdentifier(t.container)||document.body:t.container:document.body},getStepTarget:function(t){var e;if(!t||!t.target)return null;if("string"==typeof t.target)return s.getElementByIdentifier(t.target);if(Array.isArray(t.target)){var n,o;for(n=0,o=t.target.length;n<o;n++)if("string"==typeof t.target[n]&&(e=s.getElementByIdentifier(t.target[n])))return e;return null}return t.target},getI18NString:function(t){return o[t]||n[t]},setState:function(t,e,n){var o,i="";if(m&&b)try{sessionStorage.setItem(t,e)}catch(o){b=!1,this.setState(t,e,n)}else m&&sessionStorage.removeItem(t),n&&((o=new Date).setTime(o.getTime()+24*n*60*60*1e3),i="; expires="+o.toGMTString()),document.cookie=t+"="+e+i+"; path=/"},getState:function(t){var e,n,o,i=t+"=",r=document.cookie.split(";");if(m&&(o=sessionStorage.getItem(t)))return o;for(e=0;e<r.length;e++){for(n=r[e];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(i)){o=n.substring(i.length,n.length);break}}return o},clearState:function(t){m?sessionStorage.removeItem(t):this.setState(t,"",-1)},normalizePlacement:function(t){!t.placement&&t.orientation&&(t.placement=t.orientation)},flipPlacement:function(t){if(t.isRtl&&!t._isFlipped){var e,n,o=["orientation","placement"];for(n in t.xOffset&&(t.xOffset=-1*this.getPixelValue(t.xOffset)),o)e=o[n],t.hasOwnProperty(e)&&y.hasOwnProperty(t[e])&&(t[e]=y[t[e]]);t._isFlipped=!0}}}).addEvtListener(window,"load",function(){g&&c.startTour()}),l={next:[],prev:[],start:[],end:[],show:[],error:[],close:[]},a={},n={stepNums:null,nextBtn:"Next",prevBtn:"Back",doneBtn:"Done",skipBtn:"Skip",closeTooltip:"Close"},o={},(t=function(t){this.init(t)}).prototype={isShowing:!1,currStep:void 0,setPosition:function(t){var e,n,o,i,r,l,a,u,c=s.getStepTarget(t),h=this.element,f=this.arrowEl,d=t.isRtl?"right":"left";if(s.flipPlacement(t),s.normalizePlacement(t),n=h.offsetWidth,e=h.offsetHeight,s.removeClass(h,"fade-in-down fade-in-up fade-in-left fade-in-right"),o=c.getBoundingClientRect(),a=t.isRtl?o.right-n:o.left,"top"===t.placement)i=o.top-e-this.opt.arrowWidth,r=a;else if("bottom"===t.placement)i=o.bottom+this.opt.arrowWidth,r=a;else if("left"===t.placement)i=o.top,r=o.left-n-this.opt.arrowWidth;else{if("right"!==t.placement)throw new Error("Bubble placement failed because step.placement is invalid or undefined!");i=o.top,r=o.right+this.opt.arrowWidth}(l="center"!==t.arrowOffset?s.getPixelValue(t.arrowOffset):t.arrowOffset)?"top"===t.placement||"bottom"===t.placement?(f.style.top="",f.style[d]="center"===l?Math.floor(n/2-f.offsetWidth/2)+"px":l+"px"):"left"!==t.placement&&"right"!==t.placement||(f.style[d]="",f.style.top="center"===l?Math.floor(e/2-f.offsetHeight/2)+"px":l+"px"):(f.style.top="",f.style[d]=""),"center"===t.xOffset?r=o.left+c.offsetWidth/2-n/2:r+=s.getPixelValue(t.xOffset),"center"===t.yOffset?i=o.top+c.offsetHeight/2-e/2:i+=s.getPixelValue(t.yOffset),t.fixedElement||(i+=s.getScrollTop(),r+=s.getScrollLeft()),h.style.top="0",h.style.left="0",i-=(u=h.getBoundingClientRect()).top,r-=u.left,this.opt.fixedContainer||(i-=s.getScrollTop(),r-=s.getScrollLeft()),h.style.position=t.fixedElement?"fixed":"absolute",h.style.top=i+"px",h.style.left=r+"px"},render:function(t,e,n){var o,r,l,a,u,h,d,p,g,v,m=this.element;if(t?this.currStep=t:this.currStep&&(t=this.currStep),this.opt.isTourBubble?(a=c.getCurrTour())&&(r=a.customData,o=a.customRenderer,t.isRtl=t.hasOwnProperty("isRtl")?t.isRtl:a.hasOwnProperty("isRtl")?a.isRtl:this.opt.isRtl,l=a.unsafe,Array.isArray(a.steps)&&(u=a.steps.length,h=this._getStepI18nNum(this._getStepNum(u-1)),p=this._getStepNum(e)===this._getStepNum(u-1))):(r=t.customData,o=t.customRenderer,l=t.unsafe,t.isRtl=t.hasOwnProperty("isRtl")?t.isRtl:this.opt.isRtl),d=p?s.getI18NString("doneBtn"):t.showSkip?s.getI18NString("skipBtn"):s.getI18NString("nextBtn"),s.flipPlacement(t),s.normalizePlacement(t),this.placement=t.placement,v={i18n:{prevBtn:s.getI18NString("prevBtn"),nextBtn:d,closeTooltip:s.getI18NString("closeTooltip"),stepNum:this._getStepI18nNum(this._getStepNum(e)),numSteps:h},buttons:{showPrev:s.valOrDefault(t.showPrevButton,this.opt.showPrevButton)&&this._getStepNum(e)>0,showNext:s.valOrDefault(t.showNextButton,this.opt.showNextButton),showCTA:s.valOrDefault(t.showCTAButton&&t.ctaLabel,!1),ctaLabel:t.ctaLabel,showClose:s.valOrDefault(this.opt.showCloseButton,!0)},step:{num:e,isLast:s.valOrDefault(p,!1),title:t.title||"",content:t.content||"",isRtl:t.isRtl,placement:t.placement,padding:s.valOrDefault(t.padding,this.opt.bubblePadding),width:s.getPixelValue(t.width)||this.opt.bubbleWidth,customData:t.customData||{}},tour:{isTour:this.opt.isTourBubble,numSteps:u,unsafe:s.valOrDefault(l,!1),customData:r||{}}},"function"==typeof o)m.innerHTML=o(v);else if("string"==typeof o){if(!c.templates||"function"!=typeof c.templates[o])throw new Error('Bubble rendering failed - template "'+o+'" is not a function.');m.innerHTML=c.templates[o](v)}else if(i)m.innerHTML=i(v);else{if(!c.templates||"function"!=typeof c.templates[f])throw new Error('Bubble rendering failed - template "'+f+'" is not a function.');m.innerHTML=c.templates[f](v)}var b,w=m.children,y=w.length;for(g=0;g<y;g++)b=w[g],s.hasClass(b,"hopscotch-arrow")&&(this.arrowEl=b);return m.style.zIndex="number"==typeof t.zindex?t.zindex:"",this._setArrow(t.placement),this.hide(!1),this.setPosition(t),n&&n(!t.fixedElement),this},_getStepNum:function(t){var e,n=0,o=c.getSkippedStepsIndexes(),i=o.length;for(e=0;e<i;e++)o[e]<t&&n++;return t-n},_getStepI18nNum:function(t){var e=s.getI18NString("stepNums");return e&&t<e.length?t=e[t]:t+=1,t},_setArrow:function(t){s.removeClass(this.arrowEl,"down up right left"),"top"===t?s.addClass(this.arrowEl,"down"):"bottom"===t?s.addClass(this.arrowEl,"up"):"left"===t?s.addClass(this.arrowEl,"right"):"right"===t&&s.addClass(this.arrowEl,"left")},_getArrowDirection:function(){return"top"===this.placement?"down":"bottom"===this.placement?"up":"left"===this.placement?"right":"right"===this.placement?"left":void 0},show:function(){var t=this,e="fade-in-"+this._getArrowDirection();return s.removeClass(this.element,"hide"),s.addClass(this.element,e),setTimeout(function(){s.removeClass(t.element,"invisible")},50),setTimeout(function(){s.removeClass(t.element,e)},1e3),this.isShowing=!0,this},hide:function(t){var e=this.element;return t=s.valOrDefault(t,!0),e.style.top="",e.style.left="",t?(s.addClass(e,"hide"),s.removeClass(e,"invisible")):(s.removeClass(e,"hide"),s.addClass(e,"invisible")),s.removeClass(e,"animate fade-in-up fade-in-down fade-in-right fade-in-left"),this.isShowing=!1,this},destroy:function(){var t=this.element;t&&t.parentNode.removeChild(t),s.removeEvtListener(t,"click",this.clickCb)},_handleBubbleClick:function(t){var e;if("cta"===(e=function e(n){return n===t.currentTarget?null:s.hasClass(n,"hopscotch-cta")?"cta":s.hasClass(n,"hopscotch-next")?"next":s.hasClass(n,"hopscotch-prev")?"prev":s.hasClass(n,"hopscotch-close")?"close":e(n.parentElement)}((t=t||window.event).target||t.srcElement)))this.opt.isTourBubble||c.getCalloutManager().removeCallout(this.currStep.id),this.currStep.onCTA&&s.invokeCallback(this.currStep.onCTA);else if("next"===e)c.nextStep(!0);else if("prev"===e)c.prevStep(!0);else if("close"===e){if(this.opt.isTourBubble){var n=c.getCurrStepNum()===c.getCurrTour().steps.length-1;s.invokeEventCallbacks("close"),c.endTour(!0,n)}else this.opt.onClose&&s.invokeCallback(this.opt.onClose),this.opt.id&&!this.opt.isTourBubble?c.getCalloutManager().removeCallout(this.opt.id):this.destroy();s.evtPreventDefault(t)}},init:function(t){var e,n,o,i,r=document.createElement("div"),l=this,a=!1;this.element=r,i={showPrevButton:u.showPrevButton,showNextButton:u.showNextButton,bubbleWidth:u.bubbleWidth,bubblePadding:u.bubblePadding,arrowWidth:u.arrowWidth,isRtl:u.isRtl,showNumber:!0,isTourBubble:!0},t=(void 0===t?"undefined":h(t))===p?{}:t,s.extend(i,t),this.opt=i,r.className="hopscotch-bubble animated",i.isTourBubble?(o=c.getCurrTour())&&s.addClass(r,"tour-"+o.id):s.addClass(r,"hopscotch-callout no-number"),e=function(){!a&&l.isShowing&&(a=!0,setTimeout(function(){l.setPosition(l.currStep),a=!1},100))},s.addEvtListener(window,"resize",e),this.clickCb=function(t){l._handleBubbleClick(t)},s.addEvtListener(r,"click",this.clickCb),this.hide(),s.documentIsReady()?s.getContainer(i).appendChild(r):(document.addEventListener?(n=function(){document.removeEventListener("DOMContentLoaded",n),window.removeEventListener("load",n),s.getContainer(i).appendChild(r)},document.addEventListener("DOMContentLoaded",appendToBody,!1)):(appendToBody=function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",appendToBody),window.detachEvent("onload",appendToBody),document.body.appendChild(r))}),document.attachEvent("onreadystatechange",appendToBody)),s.addEvtListener(window,"load",appendToBody))}},e=function(){var e={},n={};this.createCallout=function(o){var i;if(!o.id)throw new Error("Must specify a callout id.");if(!w.test(o.id))throw new Error("Callout ID is using an invalid format. Use alphanumeric, underscores, and/or hyphens only. First character must be a letter.");if(e[o.id])throw new Error("Callout by that id already exists. Please choose a unique id.");if(!s.getStepTarget(o))throw new Error("Must specify existing target element via 'target' option.");return o.showNextButton=o.showPrevButton=!1,o.isTourBubble=!1,i=new t(o),e[o.id]=i,n[o.id]=o,i.render(o,null,function(){i.show(),o.onShow&&s.invokeCallback(o.onShow)}),i},this.getCallout=function(t){return e[t]},this.removeAllCallouts=function(){var t;for(t in e)e.hasOwnProperty(t)&&this.removeCallout(t)},this.removeCallout=function(t){var o=e[t];e[t]=null,n[t]=null,o&&o.destroy()},this.refreshCalloutPositions=function(){var t,o,i;for(t in e)e.hasOwnProperty(t)&&n.hasOwnProperty(t)&&(o=e[t],i=n[t],o&&i&&o.setPosition(i))}},c=new function(n){var d,m,b,y,C,S,T,k,x=this,E={},O=[],B=function(e){return d&&d.element&&d.element.parentNode||(d=new t(b)),e&&s.extend(d.opt,{bubblePadding:N("bubblePadding"),bubbleWidth:N("bubbleWidth"),showNextButton:N("showNextButton"),showPrevButton:N("showPrevButton"),showCloseButton:N("showCloseButton"),arrowWidth:N("arrowWidth"),isRtl:N("isRtl")}),d},N=function(t){return void 0===b?u[t]:s.valOrDefault(b[t],u[t])},P=function(){return!y||C<0||C>=y.steps.length?null:y.steps[C]},A=function(){x.nextStep()},D=function t(e,n){var o,i;C+e>=0&&C+e<y.steps.length?(C+=e,i=function(){s.getStepTarget(o)?(E[C]&&delete E[C],n(C)):(E[C]=!0,s.invokeEventCallbacks("error"),t(e,n))},(o=P()).delay?setTimeout(i,o.delay):i()):n(-1)},I=function(t,e){var n,o,i,r,l=B(),a=this;if(l.hide(),t=s.valOrDefault(t,!0),(n=P()).nextOnTargetClick&&s.removeEvtListener(s.getStepTarget(n),"click",A),o=n,i=e>0?o.multipage:C>0&&y.steps[C-1].multipage,r=function(n){var r;if(-1===n)return this.endTour(!0);t&&(r=e>0?s.invokeEventCallbacks("next",o.onNext):s.invokeEventCallbacks("prev",o.onPrev)),n===C&&(i?R():(r=s.valOrDefault(r,!0))?this.showStep(n):this.endTour(!1))},!i&&N("skipIfNoElement"))D(e,function(t){r.call(a,t)});else if(C+e>=0&&C+e<y.steps.length){if(C+=e,n=P(),!s.getStepTarget(n)&&!i)return s.invokeEventCallbacks("error"),this.endTour(!0,!1);r.call(this,C)}else if(C+e===y.steps.length)return this.endTour();return this},L=function(t){var e=y.steps[t],n=B(),o=s.getStepTarget(e);function i(){n.show(),s.invokeEventCallbacks("show",e.onShow)}C!==t&&P().nextOnTargetClick&&s.removeEvtListener(s.getStepTarget(P()),"click",A),C=t,n.hide(!1),n.render(e,t,function(t){var n,r,l,a,u,c,f,d,g,m,w,y,C,S,T,k,x,E,O,D;t&&!N("fixedContainer")?(n=i,d=B(),g=s.getScrollTop(),m=g+s.getWindowHeight(),w=s.getContainer(b).getBoundingClientRect().top+g,y=d.element,C=s.getPixelValue(y.style.top)+w,S=C+s.getPixelValue(y.offsetHeight),T=s.getStepTarget(P()).getBoundingClientRect(),k=T.top+g,x=T.bottom+g,O=S>x?S:x,D=(E=C<k?C:k)-N("scrollTopMargin"),E>=g&&(E<=g+N("scrollTopMargin")||O<=m)?n&&n():N("smoothScroll")?("undefined"==typeof YAHOO?"undefined":h(YAHOO))!==p&&h(YAHOO.env)!==p&&h(YAHOO.env.ua)!==p&&h(YAHOO.util)!==p&&h(YAHOO.util.Scroll)!==p?(r=YAHOO.env.ua.webkit?document.body:document.documentElement,a=YAHOO.util.Easing?YAHOO.util.Easing.easeOut:void 0,(l=new YAHOO.util.Scroll(r,{scroll:{to:[0,D]}},N("scrollDuration")/1e3,a)).onComplete.subscribe(n),l.animate()):v?jQuery("body, html").animate({scrollTop:D},N("scrollDuration"),n):(D<0&&(D=0),u=g>E?-1:1,c=Math.abs(g-D)/(N("scrollDuration")/10),(f=function(){var t=s.getScrollTop(),e=t+u*c;if(u>0&&e>=D||u<0&&e<=D)return e=D,n&&n(),void window.scrollTo(0,e);window.scrollTo(0,e),s.getScrollTop()!==t?setTimeout(f,10):n&&n()})()):(window.scrollTo(0,D),n&&n())):i(),e.nextOnTargetClick&&s.addEvtListener(o,"click",A)}),R()},R=function(){var t=y.id+":"+C,e=c.getSkippedStepsIndexes();e&&e.length>0&&(t+=":"+e.join(",")),s.setState(N("cookieName"),t,1)};this.getCalloutManager=function(){return(void 0===m?"undefined":h(m))===p&&(m=new e),m},this.startTour=function(t,e){var n,o={},i=this;if(!y){if(!t)throw new Error("Tour data is required for startTour.");if(!t.id||!w.test(t.id))throw new Error("Tour ID is using an invalid format. Use alphanumeric, underscores, and/or hyphens only. First character must be a letter.");y=t,function(t){var e,n,o,i={};for(e in t)t.hasOwnProperty(e)&&"id"!==e&&"steps"!==e&&(i[e]=t[e]);return k.call(this,i,!0),(n=s.getState(N("cookieName")))&&(o=n.split(":"),S=o[0],T=o[1],o.length>2&&(O=o[2].split(",")),T=parseInt(T,10)),this}.call(this,t)}if((void 0===e?"undefined":h(e))!==p){if(e>=y.steps.length)throw new Error("Specified step number out of bounds.");n=e}if(!s.documentIsReady())return g=!0,this;if(void 0===n&&y.id===S&&(void 0===T?"undefined":h(T))!==p){if(n=T,O.length>0)for(var r=0,l=O.length;r<l;r++)o[O[r]]=!0}else n||(n=0);return function(t,e,n){var o,i;if(C=t||0,E=e||{},o=P(),i=s.getStepTarget(o))n(C);else if(!i){if(s.invokeEventCallbacks("error"),E[C]=!0,N("skipIfNoElement"))return void D(1,n);n(C=-1)}}(n,o,function(t){-1!==t&&s.getStepTarget(y.steps[t])?(s.invokeEventCallbacks("start"),B().hide(!1),i.isActive=!0,s.getStepTarget(P())?i.showStep(t):(s.invokeEventCallbacks("error"),N("skipIfNoElement")&&i.nextStep(!1))):i.endTour(!1,!1)}),this},this.showStep=function(t){var e=y.steps[t],n=C;return s.getStepTarget(e)?(e.delay?setTimeout(function(){L(t)},e.delay):L(t),this):(C=t,s.invokeEventCallbacks("error"),void(C=n))},this.prevStep=function(t){return I.call(this,t,-1),this},this.nextStep=function(t){return I.call(this,t,1),this},this.endTour=function(t,e){var n,o=B();return t=s.valOrDefault(t,!0),e=s.valOrDefault(e,!0),y&&(n=P())&&n.nextOnTargetClick&&s.removeEvtListener(s.getStepTarget(n),"click",A),C=0,T=void 0,o.hide(),t&&s.clearState(N("cookieName")),this.isActive&&(this.isActive=!1,y&&e&&s.invokeEventCallbacks("end")),this.removeCallbacks(null,!0),this.resetDefaultOptions(),d&&(d.destroy(),d=null),y=null,this},this.getCurrTour=function(){return y},this.getCurrTarget=function(){return s.getStepTarget(P())},this.getCurrStepNum=function(){return C},this.getSkippedStepsIndexes=function(){var t,e=[];for(t in E)e.push(t);return e},this.refreshBubblePosition=function(){var t=P();return t&&B().setPosition(t),this.getCalloutManager().refreshCalloutPositions(),this},this.listen=function(t,e,n){return t&&l[t].push({cb:e,fromTour:n}),this},this.unlisten=function(t,e){var n,o,i=l[t];for(n=0,o=i.length;n<o;++n)i[n].cb===e&&i.splice(n,1);return this},this.removeCallbacks=function(t,e){var n,o,i,r;for(r in l)if(!t||t===r)if(e)for(o=0,i=(n=l[r]).length;o<i;++o)n[o].fromTour&&(n.splice(o--,1),--i);else l[r]=[];return this},this.registerHelper=function(t,e){"string"==typeof t&&"function"==typeof e&&(a[t]=e)},this.unregisterHelper=function(t){a[t]=null},this.invokeHelper=function(t){var e,n,o=[];for(e=1,n=arguments.length;e<n;++e)o.push(arguments[e]);a[t]&&a[t].call(null,o)},this.setCookieName=function(t){return b.cookieName=t,this},this.resetDefaultOptions=function(){return b={},this},this.resetDefaultI18N=function(){return o={},this},this.getState=function(){return s.getState(N("cookieName"))},k=function(t,e){var n,i,r,l=["next","prev","start","end","show","error","close"];for(b||this.resetDefaultOptions(),s.extend(b,t),t&&s.extend(o,t.i18n),i=0,r=l.length;i<r;++i)t[n="on"+l[i].charAt(0).toUpperCase()+l[i].substring(1)]&&this.listen(l[i],t[n],e);return B(!0),this},this.configure=function(t){return k.call(this,t,!1)},this.setRenderer=function(t){var e=void 0===t?"undefined":h(t);return"string"===e?(f=t,i=void 0):"function"===e&&(i=t),this},this.setEscaper=function(t){return"function"==typeof t&&(r=t),this},function(t){t&&this.configure(t)}.call(this,n)},function(){var t={escape:function(t){return r?r(t):null==t?"":(""+t).replace(new RegExp("[&<>\"']","g"),function(t){return"&"==t?"&amp;":"<"==t?"&lt;":">"==t?"&gt;":'"'==t?"&quot;":"'"==t?"&#x27;":void 0})}};this.templates=this.templates||{},this.templates.bubble_default=function(e){var n,o="";t.escape,Array.prototype.join;function i(e,n){return n?t.escape(e):e}o+="\n";var r=e.i18n,s=e.buttons,l=e.step,a=e.tour;return o+='\n<div class="hopscotch-bubble-container" style="width: '+(null==(n=l.width)?"":n)+"px; padding: "+(null==(n=l.padding)?"":n)+'px;">\n  ',a.isTour&&(o+='<span class="hopscotch-bubble-number">'+(null==(n=r.stepNum)?"":n)+"</span>"),o+='\n  <div class="hopscotch-bubble-content">\n    ',""!==l.title&&(o+='<h3 class="hopscotch-title">'+(null==(n=i(l.title,a.unsafe))?"":n)+"</h3>"),o+="\n    ",""!==l.content&&(o+='<div class="hopscotch-content">'+(null==(n=i(l.content,a.unsafe))?"":n)+"</div>"),o+='\n  </div>\n  <div class="hopscotch-actions">\n    ',s.showPrev&&(o+='<button class="hopscotch-nav-button prev hopscotch-prev">'+(null==(n=r.prevBtn)?"":n)+"</button>"),o+="\n    ",s.showCTA&&(o+='<button class="hopscotch-nav-button next hopscotch-cta">'+(null==(n=s.ctaLabel)?"":n)+"</button>"),o+="\n    ",s.showNext&&(o+='<button class="hopscotch-nav-button next hopscotch-next">'+(null==(n=r.nextBtn)?"":n)+"</button>"),o+="\n  </div>\n  ",s.showClose&&(o+='<button class="hopscotch-bubble-close hopscotch-close">'+(null==(n=r.closeTooltip)?"":n)+"</button>"),o+='\n</div>\n<div class="hopscotch-bubble-arrow-container hopscotch-arrow">\n  <div class="hopscotch-bubble-arrow-border"></div>\n  <div class="hopscotch-bubble-arrow"></div>\n</div>\n'}}.call(c),c});